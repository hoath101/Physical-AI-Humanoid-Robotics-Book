"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[830],{8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(6540);const i={},o=r.createContext(i);function l(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(o.Provider,{value:n},e.children)}},9527:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"module-1-ros2/rclpy-basics","title":"rclpy Basics","description":"rclpy is the Python client library for ROS 2. It provides the Python API for developing ROS 2 applications, allowing you to create nodes, publish/subscribe to topics, provide/call services, and interact with other ROS 2 concepts.","source":"@site/docs/module-1-ros2/rclpy-basics.md","sourceDirName":"module-1-ros2","slug":"/module-1-ros2/rclpy-basics","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/rclpy-basics","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Practical Exercises - ROS 2 Fundamentals","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/practical-exercises"},"next":{"title":"URDF Description","permalink":"/Physical-AI-Humanoid-Robotics-Book/docs/module-1-ros2/urdf-description"}}');var i=s(4848),o=s(8453);const l={},a="rclpy Basics",t={},c=[{value:"Installation and Setup",id:"installation-and-setup",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:2},{value:"Creating Publishers and Subscribers",id:"creating-publishers-and-subscribers",level:2},{value:"Publisher",id:"publisher",level:3},{value:"Subscriber",id:"subscriber",level:3},{value:"Creating Services and Clients",id:"creating-services-and-clients",level:2},{value:"Service Server",id:"service-server",level:3},{value:"Parameters",id:"parameters",level:2},{value:"Quality of Service (QoS)",id:"quality-of-service-qos",level:2},{value:"Working with Custom Messages",id:"working-with-custom-messages",level:2},{value:"Error Handling and Logging",id:"error-handling-and-logging",level:2},{value:"Exercise",id:"exercise",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rclpy-basics",children:"rclpy Basics"})}),"\n",(0,i.jsx)(n.p,{children:"rclpy is the Python client library for ROS 2. It provides the Python API for developing ROS 2 applications, allowing you to create nodes, publish/subscribe to topics, provide/call services, and interact with other ROS 2 concepts."}),"\n",(0,i.jsx)(n.h2,{id:"installation-and-setup",children:"Installation and Setup"}),"\n",(0,i.jsx)(n.p,{children:"rclpy is typically installed as part of the ROS 2 Python development packages:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# If you installed ROS 2 from packages, rclpy should already be available\n# Otherwise, install the Python development packages:\nsudo apt install python3-ros-dev-tools\n"})}),"\n",(0,i.jsx)(n.h2,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,i.jsx)(n.p,{children:"Every ROS 2 Python node follows a similar structure:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        super().__init__('node_name')\n        # Node initialization code here\n        pass\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-publishers-and-subscribers",children:"Creating Publishers and Subscribers"}),"\n",(0,i.jsx)(n.h3,{id:"publisher",children:"Publisher"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass PublisherNode(Node):\n    def __init__(self):\n        super().__init__('publisher_node')\n\n        # Create a publisher\n        self.publisher = self.create_publisher(String, 'topic_name', 10)\n\n        # Create a timer to periodically publish messages\n        timer_period = 1.0  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = 'Hello from publisher'\n        self.publisher.publish(msg)\n        self.get_logger().info(f'Publishing: {msg.data}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = PublisherNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscriber",children:"Subscriber"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SubscriberNode(Node):\n    def __init__(self):\n        super().__init__('subscriber_node')\n\n        # Create a subscriber\n        self.subscription = self.create_subscription(\n            String,\n            'topic_name',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: {msg.data}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = SubscriberNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"creating-services-and-clients",children:"Creating Services and Clients"}),"\n",(0,i.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass ServiceServer(Node):\n    def __init__(self):\n        super().__init__('service_server')\n\n        # Create a service\n        self.service = self.create_service(\n            AddTwoInts,\n            'add_two_ints',\n            self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Request received: {request.a} + {request.b} = {response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ServiceServer()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 nodes can use parameters for configuration:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass ParameterNode(Node):\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values\n        self.declare_parameter('robot_name', 'humanoid_robot')\n        self.declare_parameter('max_velocity', 1.0)\n\n        # Get parameter values\n        self.robot_name = self.get_parameter('robot_name').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n\n        self.get_logger().info(f'Robot: {self.robot_name}, Max Velocity: {self.max_velocity}')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = ParameterNode()\n\n    try:\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"quality-of-service-qos",children:"Quality of Service (QoS)"}),"\n",(0,i.jsx)(n.p,{children:"QoS profiles control the behavior of publishers and subscribers:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, DurabilityPolicy\n\n# Create a QoS profile for reliable communication\nqos_profile = QoSProfile(\n    depth=10,\n    reliability=ReliabilityPolicy.RELIABLE,\n    durability=DurabilityPolicy.VOLATILE\n)\n\n# Use the QoS profile when creating a publisher\npublisher = self.create_publisher(String, 'topic_name', qos_profile)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"working-with-custom-messages",children:"Working with Custom Messages"}),"\n",(0,i.jsx)(n.p,{children:"To use custom message types, you need to create them in a package and import them:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Assuming you have a custom message package called 'my_robot_msgs'\nfrom my_robot_msgs.msg import JointState\n\nclass CustomMessageNode(Node):\n    def __init__(self):\n        super().__init__('custom_message_node')\n        self.publisher = self.create_publisher(JointState, 'joint_states', 10)\n\n    def publish_joint_state(self, positions):\n        msg = JointState()\n        msg.position = positions\n        self.publisher.publish(msg)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"error-handling-and-logging",children:"Error Handling and Logging"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 provides different logging levels:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class LoggingNode(Node):\n    def __init__(self):\n        super().__init__('logging_node')\n\n        # Different logging levels\n        self.get_logger().debug('Debug message')\n        self.get_logger().info('Info message')\n        self.get_logger().warn('Warning message')\n        self.get_logger().error('Error message')\n        self.get_logger().fatal('Fatal message')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"exercise",children:"Exercise"}),"\n",(0,i.jsx)(n.p,{children:"Create a simple rclpy node that:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Publishes joint position commands to control a humanoid robot"}),"\n",(0,i.jsx)(n.li,{children:"Subscribes to sensor feedback from the robot"}),"\n",(0,i.jsx)(n.li,{children:"Uses parameters to configure the control behavior"}),"\n",(0,i.jsx)(n.li,{children:"Implements proper error handling and logging"}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);